<html>
<head>
<title>WP PWA Title</title>
<meta name="description" content="">

<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="application-name" content="WP PWA">
<meta name="apple-mobile-web-app-title" content="WP PWA Title">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="msapplication-starturl"
    content="/?utm_source=homescreen&utm_medium=Addtohomescreen&utm_campaign=homescreen">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta name="browsermode" content="application">
<meta name="x5-page-mode" content="app">

<meta name="theme-color" content="#ffffff">
<link rel="manifest" href="/manifest.json">
</head>
<body>
<div id="installed" style="display: none">You Installed! <button id="save">Commemorate</button></div>
<div>You're <span id="not_in_app">not </span>in the app!</div>
<div id="in_app">You're definitely in the app!</div>
<script type="text/javascript">
const CACHE_URL = '/app_already_installed';
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js');
}
if (window.navigator.standalone == true) {
    fetch(CACHE_URL, { method: "POST", body: JSON.stringify({ app_already_installed: true }) }).then(() => {
        document.querySelector("#installed").style = "display: block";
    });
    document.querySelector("#not_in_app").style = "display: none";
} else {
    fetch(CACHE_URL).then(response => response.json()).then(data => {
        if ('app_already_installed' in data && data['app_already_installed']) {
            document.querySelector("#installed").style = "display: block";
        }
    });
    document.querySelector("#in_app").style = "display: none";
}
document.querySelector("#save").onclick = generateToken;
function generateToken() {
    fetch(CACHE_URL, { method: "POST", body: JSON.stringify({ app_already_installed: true }) }).then(() => {
        console.log("SAVED");
    });
}
function getToken() {
    fetch(CACHE_URL).then(response => response.json()).then(json => {
        console.log("GOT:", JSON.stringify(json));
    });
}
</script>
<script async="" src="/pwacompat.js"></script>
</body>
</html>